<html>

<head>
    <title>Damage Calculator</title>
    <style>
        div.atkType {
            width: 3em;
            height: 1.5em;
            font-size: 1.5em;
            float: left;
            text-align: center;
            user-select: none;
        }

        div.atkType:hover {
            background-color: rgb(179, 179, 179) !important;
        }

        div.elementType {
            width: 4em;
            height: 1.5em;
            font-size: 1.5em;
            float: left;
            text-align: center;
            user-select: none;
        }

        div.elementType:hover {
            background-color: rgb(179, 179, 179) !important;
        }

        div.calcType {
            width: 5em;
            height: 1.5em;
            font-size: 1.5em;
            float: left;
            text-align: center;
            user-select: none;
        }

        div.calcType:hover {
            background-color: rgb(179, 179, 179) !important;
        }

        div.inputSpace {
            width: 600px;
            height: 500px;
            display: block;
            margin-top: 3em;
            left: 0;
            clear: left;
            display: none;
            user-select: none;
        }

        input[type='text'] {
            width: 4em;
        }
    </style>
    <script src='jquery-3.6.0.min.js'></script>
    <script>
        //計算頁面控制
        var physical = true, magical = false, elemental = true, nonElemental = false;
        var pwrBase = true, itgBase = false, spdBase = false;
        function colorJudge(id, key) {
            if (key) {
                document.getElementById(id).style.backgroundColor = 'rgba(192, 192, 192, 0.9)';
            }
            else {
                document.getElementById(id).style.backgroundColor = 'rgba(192, 192, 192, 0.5)';
            }
        }
        function inputSpaceDisplay(id, key1, key2, key3) {
            if (key1 && key2 && key3) {
                document.getElementById(id).style.display = 'block';
            }
            else {
                document.getElementById(id).style.display = 'none';
            }
        }
        function allInputSpaceDisplay() {
            inputSpaceDisplay('phyElePwr', physical, elemental, pwrBase)
            inputSpaceDisplay('phyEleItg', physical, elemental, itgBase)
            inputSpaceDisplay('phyEleSpd', physical, elemental, spdBase)
            inputSpaceDisplay('phyNonPwr', physical, nonElemental, pwrBase)
            inputSpaceDisplay('phyNonItg', physical, nonElemental, itgBase)
            inputSpaceDisplay('phyNonSpd', physical, nonElemental, spdBase)
            inputSpaceDisplay('magElePwr', magical, elemental, pwrBase)
            inputSpaceDisplay('magEleItg', magical, elemental, itgBase)
            inputSpaceDisplay('magEleSpd', magical, elemental, spdBase)
            inputSpaceDisplay('magNonPwr', magical, nonElemental, pwrBase)
            inputSpaceDisplay('magNonItg', magical, nonElemental, itgBase)
            inputSpaceDisplay('magNonSpd', magical, nonElemental, spdBase)
        }
    </script>
    <script>
        $('document').ready(function () {
            //限定輸入正整數或正浮點數
            $(':text.nature').on('input', (function () {
                $(this).val(this.value.replace(/[^0-9]/g, ""));
            }))
            $(':text.float').on('input', (function () {
                $(this).val(this.value.replace(/[^0-9.]/g, ""));
            }))
            //收合
            function OnOff(checkbox){
                var target = $(checkbox).parent().next()
                target.hide();
                $(checkbox).click(function () {
                    if ($(this).prop('checked')) {
                        $(this).parent().next().show();
                    }
                    else {
                        $(this).parent().next().hide();
                    }
                })}
            //蓄珠數值收合
            OnOff('.stackCheck');
            //挺身收合
            OnOff('.bodyCheck');
            //腕力buff收合
            OnOff('.PwrBuffCheck');
            //腕力debuff收合
            OnOff('.PwrDebuffCheck');
            //知性buff收合
            OnOff('.ItgBuffCheck');
            //知性debuff收合
            OnOff('.ItgDebuffCheck');
            //增減輸入欄數量(遞減加算)
            $('.plusButton').click(function(){
                $(this).parent().next().append('<span>, <input type="text" class="Decrease float"> % </span>')
            })
            $('.minusButton').click(function(){
                $(this).parent().next().children().last().remove()
                if($(this).parent().next().children().length == 0){
                    $(this).parent().next().append('<span><input type="text" class="Decrease float"> % </span>')
                }
                bros = $(this).parent().next().children().children()
                var x = bros.length;
                var y = [];
                for(var i = 0; i<x; i++){
                    y.push(Number(bros.eq(i).val()));
                };
                y.sort(function(a,b){return b-a;});
                var stack = y[0]; sum = y[0]
                for(var a = 1; a<x; a++){
                    stack = stack*y[a]*0.01;
                    sum = sum + stack;
                };
                sum = Math.floor(sum*100)/100;
                $(this).parent().next().next().next().text(sum);
            })
            //輸出遞減加算效果
            $(document).on('change','.Decrease',(function(){
                bros = $(this).parent().parent().children().children()
                var x = bros.length;
                var y = [];
                for(var i = 0; i<x; i++){
                    y.push(Number(bros.eq(i).val()));
                };
                y.sort(function(a,b){return b-a;});
                var stack = y[0]; sum = y[0]
                for(var a = 1; a<x; a++){
                    stack = stack*y[a]*0.01;
                    sum = sum + stack;
                };
                sum = Math.floor(sum*100)/100;
                $(this).parent().parent().next().next().text(sum);
            }))
        })
    </script>
</head>

<body onpaste='return false'>
    <h1>※請選擇攻擊類別</h1>
    <div id='physical' class='atkType'>物理</div>
    <div id='magical' class='atkType'>魔法</div>
    <script>//物理魔法控制
        document.getElementById('physical').style.background = 'rgba(192, 192, 192, 0.9)'
        document.getElementById('magical').style.background = 'rgba(192, 192, 192, 0.5)'
        document.getElementById('physical').onclick = function () {
            physical = true; magical = false; allInputSpaceDisplay();
            colorJudge("physical", physical); colorJudge("magical", magical);
        }
        document.getElementById('magical').onclick = function () {
            physical = false; magical = true; allInputSpaceDisplay();
            colorJudge("physical", physical); colorJudge("magical", magical);
        }</script>
    <h1 style="clear:left"><br>※請選擇屬性</h1>
    <div id='elemental' class='elementType'>有屬性</div>
    <div id='nonElemental' class='elementType'>無屬性</div>
    <script>//屬性控制
        document.getElementById('elemental').style.backgroundColor = 'rgba(192, 192, 192, 0.9)'
        document.getElementById('nonElemental').style.backgroundColor = 'rgba(192, 192, 192, 0.5)'
        document.getElementById('elemental').onclick = function () {
            elemental = true; nonElemental = false; allInputSpaceDisplay();
            colorJudge("elemental", elemental); colorJudge("nonElemental", nonElemental)
        }
        document.getElementById('nonElemental').onclick = function () {
            elemental = false; nonElemental = true; allInputSpaceDisplay();
            colorJudge("elemental", elemental); colorJudge("nonElemental", nonElemental)
        }</script>
    <h1 style="clear:left"><br>※請選擇計算類別</h1>
    <div id='pwrBase' class='calcType'>腕力依存</div>
    <div id='itgBase' class='calcType'>知性依存</div>
    <div id='spdBase' class='calcType'>速度依存</div>
    <script>//依存控制
        document.getElementById('pwrBase').style.backgroundColor = 'rgba(192, 192, 192, 0.9)'
        document.getElementById('itgBase').style.backgroundColor = 'rgba(192, 192, 192, 0.5)'
        document.getElementById('spdBase').style.backgroundColor = 'rgba(192, 192, 192, 0.5)'
        document.getElementById('pwrBase').onclick = function () {
            pwrBase = true; itgBase = false; spdBase = false; allInputSpaceDisplay();
            colorJudge("pwrBase", pwrBase); colorJudge("itgBase", itgBase); colorJudge("spdBase", spdBase);
        }
        document.getElementById('itgBase').onclick = function () {
            pwrBase = false; itgBase = true; spdBase = false; allInputSpaceDisplay();
            colorJudge("pwrBase", pwrBase); colorJudge("itgBase", itgBase); colorJudge("spdBase", spdBase);
        }
        document.getElementById('spdBase').onclick = function () {
            pwrBase = false; itgBase = false; spdBase = true; allInputSpaceDisplay();
            colorJudge("pwrBase", pwrBase); colorJudge("itgBase", itgBase); colorJudge("spdBase", spdBase);
        }</script>
    <br><br>
    <div id='phyElePwr' class='inputSpace' style='display:block'>
        <h2>◎ 屬性物理傷害(腕力依存)</h2>
        <form>
            <h3>1.基礎數值</h3>
            <div><!--攻擊part-->
                腕力<input id='Pwr1' type='text' value='' class='nature'>&nbsp
                武器攻擊<input id='WpAtk1' type='text' value='' class='nature'>
            </div><br>
            <div><!--魔力part-->
                知性<input id='Itg1' type='text' value='' class='nature'>&nbsp
                武器魔力<input id='WpMatk1' type='text' value='' class='nature'>
            </div><br>
            <div><!--蓄珠part-->
                <input id='stack1' type='checkbox' class='stackCheck'>蓄珠數值提升
            </div>
            <div id='StackAddition1' class='stackAddition'>
                &nbsp&nbsp&nbsp&nbsp&nbsp腕力提升<input id='stackPwr1' type='text' class='nature'>&nbsp
                知性提升<input id='stackItg1' type='text' class='nature'>
            </div><br>
            <span><!--挺身part-->
                <input id='body1' type='checkbox' class='bodyCheck'>挺身
            </span>
            <span id='EdrSpr1' class='EdrSpr'>
                &nbsp&nbsp&nbsp&nbsp&nbsp耐力<input id='Edr1' type='text' class='nature'>&nbsp
                精神<input id='Spr1' type='text' class='nature'>
            </span><br><br>
            <div><!--逆境part-->
                <input id='adversity1' type='checkbox'>逆境
            </div><br>
            <span><!--腕力BUFF part-->
                <input id='PwrBuff1' type='checkbox' class='PwrBuffCheck'>腕力BUFF
            </span>
            <span id='PwrBuffBlock1' class='PwrBuffBlock'>&nbsp&nbsp&nbsp&nbsp
                <span>
                    <input type='button' class='plusButton' value='＋'>
                    <input type='button' class='minusButton' value='－'>
                </span>
                <span id='PwrBuffInput1'>
                    <span><input type="text" class="Decrease float"> % </span>
                </span><br>&nbsp&nbsp&nbsp&nbsp
                腕力BUFF效果 = <span id='PwrBuffOutput1'>0</span> %
            </span><br><br>
            <span><!--腕力DEBUFF part-->
                <input id='PwrDebuff1' type='checkbox' class='PwrDebuffCheck'>腕力DEBUFF
            </span>
            <span id='PwrDebuffBlock1' class='PwrDebuffBlock'>&nbsp&nbsp&nbsp&nbsp
                <span>
                    <input type='button' class='plusButton' value='＋'>
                    <input type='button' class='minusButton' value='－'>
                </span>
                <span id='PwrDebuffInput1'>
                    <span><input type="text" class="Decrease float"> % </span>
                </span><br>&nbsp&nbsp&nbsp&nbsp
                腕力DEBUFF效果 = <span id='PwrDebuffOutput1'>0</span> %
            </span><br><br>
            <span><!--知性BUFF part-->
                <input id='ItgBuff1' type='checkbox' class='ItgBuffCheck'>知性BUFF
            </span>
            <span id='ItgBuffBlock1' class='ItgBuffBlock'>&nbsp&nbsp&nbsp&nbsp
                <span>
                    <input type='button' class='plusButton' value='＋'>
                    <input type='button' class='minusButton' value='－'>
                </span>
                <span id='ItgBuffInput1'>
                    <span><input type="text" class="Decrease float"> % </span>
                </span><br>&nbsp&nbsp&nbsp&nbsp
                知性BUFF效果 = <span id='ItgBuffOutput1'>0</span> %
            </span><br><br>
            <span><!--知性DEBUFF part-->
                <input id='ItgDebuff1' type='checkbox' class='ItgDebuffCheck'>知性DEBUFF
            </span>
            <span id='ItgDebuffBlock1' class='ItgDebuffBlock'>&nbsp&nbsp&nbsp&nbsp
                <span>
                    <input type='button' class='plusButton' value='＋'>
                    <input type='button' class='minusButton' value='－'>
                </span>
                <span id='ItgDebuffInput1'>
                    <span><input type="text" class="Decrease float"> % </span>
                </span><br>&nbsp&nbsp&nbsp&nbsp
                知性DEBUFF效果 = <span id='ItgDebuffOutput1'>0</span> %
            </span><br><br>
            <div><!--技能part-->
                技能倍率<input id='SkillMul1' type='text' value='100' class='nature'> % &nbsp
                連擊數<input id='Hits1' type='text' value='1' class='nature'>
            </div><br>
            <div><!--敵方數值part-->
                敵方物防<input id='Def1' type='text' value='174' class='nature'>
            </div>
        </form>
        <h3>2.增傷計算</h3>
    </div>
    <div id='phyEleItg' class='inputSpace' style='display:none'>
        <h2>◎ 屬性物理傷害(知性依存)</h2>
    </div>
    <div id='phyEleSpd' class='inputSpace' style='display:none'>
        <h2>◎ 屬性物理傷害(速度依存)</h2>
    </div>
    <div id='phyNonPwr' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性物理傷害(腕力依存)</h2>
    </div>
    <div id='phyNonItg' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性物理傷害(知性依存)</h2>
    </div>
    <div id='phyNonSpd' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性物理傷害(速度依存)</h2>
    </div>
    <div id='magElePwr' class='inputSpace' style='display:none'>
        <h2>◎ 屬性魔法傷害(腕力依存)</h2>
    </div>
    <div id='magEleItg' class='inputSpace' style='display:none'>
        <h2>◎ 屬性魔法傷害(知性依存)</h2>
    </div>
    <div id='magEleSpd' class='inputSpace' style='display:none'>
        <h2>◎ 屬性魔法傷害(速度依存)</h2>
        <p>目前沒有，有了再用</p>
    </div>
    <div id='magNonPwr' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性魔法傷害(腕力依存)</h2>
    </div>
    <div id='magNonItg' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性魔法傷害(知性依存)</h2>
    </div>
    <div id='magNonSpd' class='inputSpace' style='display:none'>
        <h2>◎ 無屬性魔法傷害(速度依存)</h2>
        <p>目前沒有，有了再用</p>
    </div>
</body>

</html>